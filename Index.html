<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Arya D·ªãch</title>

  <!-- Tesseract OCR -->
  <script src="https://cdn.jsdelivr.net/npm/tesseract.js@4/dist/tesseract.min.js"></script>

  <style>
    body {
    background-image: url("assets/background.jpg");
    background-size: cover;     /* Cho ·∫£nh ph·ªß full m√†n */
    background-position: center; /* CƒÉn gi·ªØa */
    background-attachment: fixed; /* ·∫¢nh ƒë·ª©ng y√™n khi k√©o trang */
    backdrop-filter: blur(4px); /* L√†m m·ªù nh·∫π */
    font-family: Arial;
    }

    .container {
      background: rgba(255, 255, 255, 0.55);
      padding: 25px;
      border-radius: 15px;
      max-width: 850px;
      margin: auto;
      box-shadow: 0 0 20px rgba(0,0,0,0.2);
    }

    textarea {
      width: 100%;
      height: 140px;
      padding: 10px;
      font-size: 16px;
      border-radius: 8px;
      border: 1px solid #ccc;
      margin-top: 10px;
      margin-bottom: 20px;
      resize: none;
    }

    select, button {
      padding: 10px;
      font-size: 16px;
      border-radius: 6px;
      margin: 5px;
    }

    button {
      border: none;
      cursor: pointer;
      background-color: #4CAF50;
      color: white;
    }
    button:hover {
      background-color: #45a049;
    }

    .title {
      font-size: 32px;
      font-weight: bold;
      margin-bottom: 20px;
      text-align: center;
      color: #222;
      text-shadow: 0 0 5px white;
    }
  </style>
</head>

<body>

<div class="container">

  <div class="title">üå∏ Arya Translator - Made by Mikhailovna Hoang üå∏</div>

  <!-- Ng√¥n ng·ªØ -->
  <div>
    <label>Ng√¥n ng·ªØ ngu·ªìn:</label>
    <select id="sourceLang">
      <option value="auto">T·ª± ƒë·ªông</option>
      <option value="en">Ti·∫øng Anh</option>
      <option value="vi">Ti·∫øng Vi·ªát</option>
      <option value="ja">Ti·∫øng Nh·∫≠t</option>
      <option value="ko">Ti·∫øng H√†n</option>
      <option value="zh-CN">Trung Gi·∫£n Th·ªÉ</option>
      <option value="zh-TW">Trung Ph·ªìn Th·ªÉ</option>
      <option value="fr">Ti·∫øng Ph√°p</option>
      <option value="de">Ti·∫øng ƒê·ª©c</option>
      <option value="es">T√¢y Ban Nha</option>
      <option value="ru">Ti·∫øng Nga</option>
    </select>

    <label>Ng√¥n ng·ªØ ƒë√≠ch:</label>
    <select id="targetLang">
      <option value="vi">Ti·∫øng Vi·ªát</option>
      <option value="en">Ti·∫øng Anh</option>
      <option value="ja">Ti·∫øng Nh·∫≠t</option>
      <option value="ko">Ti·∫øng H√†n</option>
      <option value="zh-CN">Trung Gi·∫£n Th·ªÉ</option>
      <option value="zh-TW">Trung Ph·ªìn Th·ªÉ</option>
      <option value="fr">Ti·∫øng Ph√°p</option>
      <option value="de">Ti·∫øng ƒê·ª©c</option>
      <option value="es">T√¢y Ban Nha</option>
      <option value="ru">Ti·∫øng Nga</option>
    </select>
  </div>

  <!-- √î nh·∫≠p -->
  <textarea id="inputText" placeholder="Nh·∫≠p ho·∫∑c qu√©t vƒÉn b·∫£n..."></textarea>

  <!-- N√∫t ch·ª©c nƒÉng -->
  <button onclick="translateText()">D·ªãch</button>
  <button onclick="speakText()">üîä Gi·ªçng ƒë·ªçc</button>
  <button onclick="openCamera()">üì∑ M·ªü Camera</button>
  <button onclick="openFile()">üñº Ch·ªçn ·∫£nh</button>

  <input type="file" id="fileInput" accept="image/*" style="display:none">

  <!-- Camera preview -->
  <video id="camera" width="350" autoplay style="display:none; margin-top:10px; border-radius:10px;"></video>
  <button id="captureBtn" onclick="captureImage()" style="display:none;">üìå Ch·ª•p & Qu√©t</button>

  <!-- K·∫øt qu·∫£ -->
  <textarea id="outputText" placeholder="K·∫øt qu·∫£ d·ªãch s·∫Ω hi·ªán ·ªü ƒë√¢y..."></textarea>

</div>

<script>
/* --- D·ªäCH --- */
function translateText() {
  const text = document.getElementById("inputText").value;
  const source = document.getElementById("sourceLang").value;
  const target = document.getElementById("targetLang").value;

  if (!text.trim()) {
    document.getElementById("outputText").value = "S∆∞ ƒë·ªá ch∆∞a nh·∫≠p g√¨ c·∫£...";
    return;
  }

  const url =
    "https://translate.googleapis.com/translate_a/single?client=gtx&sl=" +
    source + "&tl=" + target + "&dt=t&q=" + encodeURIComponent(text);

  fetch(url)
    .then(res => res.json())
    .then(data => {
      document.getElementById("outputText").value = data[0][0][0];
    })
    .catch(() => {
      document.getElementById("outputText").value = "L·ªói d·ªãch, th·ª≠ l·∫°i nhen s∆∞ ƒë·ªá.";
    });
}

/* --- GI·ªåNG ƒê·ªåC --- */
function speakText() {
  const text = document.getElementById("outputText").value;
  if (!text.trim()) return;

  const msg = new SpeechSynthesisUtterance(text);
  msg.lang = document.getElementById("targetLang").value;
  speechSynthesis.speak(msg);
}

/* --- M·ªû FILE --- */
function openFile() {
  document.getElementById("fileInput").click();
}

document.getElementById("fileInput").addEventListener("change", function () {
  const file = this.files[0];
  if (!file) return;

  const reader = new FileReader();
  reader.onload = function () {
    processImage(reader.result);
  };
  reader.readAsDataURL(file);
});

/* --- CAMERA --- */
function openCamera() {
  const video = document.getElementById("camera");
  const btn = document.getElementById("captureBtn");

  navigator.mediaDevices.getUserMedia({ video: true })
    .then(stream => {
      video.srcObject = stream;
      video.style.display = "block";
      btn.style.display = "inline-block";
    })
    .catch(() => alert("Kh√¥ng m·ªü ƒë∆∞·ª£c camera"));
}

function captureImage() {
  const video = document.getElementById("camera");
  const canvas = document.createElement("canvas");
  canvas.width = video.videoWidth;
  canvas.height = video.videoHeight;

  const ctx = canvas.getContext("2d");
  ctx.drawImage(video, 0, 0);

  const imageData = canvas.toDataURL("image/png");

  processImage(imageData);
}

/* --- OCR (QU√âT VƒÇN B·∫¢N) --- */
function processImage(img) {
  document.getElementById("inputText").value = "‚è≥ ƒêang qu√©t ch·ªØ...";

  Tesseract.recognize(img, "eng+vie+jpn", {
    logger: m => console.log(m)
  })
  .then(result => {
    document.getElementById("inputText").value = result.data.text || "Kh√¥ng nh·∫≠n ƒë∆∞·ª£c ch·ªØ.";
  });
}
</script>

</body>
</html>
